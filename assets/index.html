<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gerador de Contrato • Is Help</title>

  <!-- Fonte minimalista -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <!-- html2pdf.js (html2canvas + jsPDF) -->
  <script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>

  <style>
    :root{
      --bg:#0b0d10;--card:#13161a;--ink:#e7ecf3;--muted:#a6b0bf;--brand:#4f8cff;--ok:#22c55e;
      --radius:16px;--shadow:0 10px 30px rgba(0,0,0,.35);--maxw:1100px;
    }
    *{box-sizing:border-box}
    html,body{background:var(--bg);color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.55}
    .wrap{max-width:var(--maxw);margin:32px auto;padding:0 16px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:24px}
    .card{background:var(--card);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);box-shadow:var(--shadow)}
    .card h2{margin:0;padding:18px 20px;border-bottom:1px solid rgba(255,255,255,.06);font-size:18px}
    .card .body{padding:20px}
    label{display:block;font-size:12px;text-transform:uppercase;letter-spacing:.06em;color:var(--muted);margin-bottom:6px}
    input,textarea,select{width:100%;background:#0e1115;color:var(--ink);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:12px 14px;outline:none}
    input:focus,textarea:focus,select:focus{border-color:var(--brand);box-shadow:0 0 0 4px rgba(79,140,255,.15)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn{appearance:none;border:1px solid rgba(255,255,255,.1);background:#0e1115;color:var(--ink);padding:10px 14px;border-radius:12px;cursor:pointer;transition:transform .08s ease,border-color .2s ease,background .2s ease;font-weight:600;user-select:none}
    .btn:hover{border-color:rgba(255,255,255,.3)}
    .btn:active{transform:translateY(1px)}
    .btn.primary{background:var(--brand);border-color:var(--brand);color:#06090f}
    .btn.success{background:var(--ok);border-color:var(--ok);color:#041b0e}
    .btn.ghost{background:transparent}
    .hint{color:var(--muted);font-size:12px;margin-top:6px}

    /* Preview do contrato */
    .preview{background:#fff;color:#111827;border-radius:12px;overflow:hidden}
    .preview .sheet{padding:28mm 22mm;min-height:297mm;width:210mm;margin:0 auto;background:#fff}
    .logo-wrap{display:flex;justify-content:center;margin-bottom:8mm}
    .logo-wrap img{max-height:40px;opacity:.95}
    .header-title{font-size:18pt;margin:0 0 2mm 0;text-align:center}
    .meta{font-size:10pt;color:#374151;margin:0 0 6mm 0;text-align:center}
    .section-title{font-size:12pt;font-weight:700;margin:18px 0 6px;color:#111827}
    .contract p{margin:8px 0;font-size:11pt;text-align:justify}
    .contract ul{margin:8px 0 8px 18px}
    .two-cols{columns:2;column-gap:22px}
    .sign{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-top:28px}
    .sign div{text-align:center;margin-top:24px}
    .sign-line{border-top:1px solid #111;padding-top:6px}

    /* Impressão */
    @media print{
      body{background:#fff}
      .grid{display:block}
      .card:first-child{display:none}
      .preview{box-shadow:none;border:0}
      .preview .sheet{width:auto;min-height:auto;padding:20mm}
    }

    /* Responsivo */
    @media (max-width:980px){.grid{grid-template-columns:1fr}.preview .sheet{width:auto}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1 style="font-size:22px;margin:0 0 10px">Gerador de Contrato — Is Help</h1>
    <p class="hint">Preencha os campos, clique em <strong>Gerar contrato</strong> e depois em <strong>Baixar PDF</strong>. Seus dados ficam salvos no navegador (localStorage).</p>

    <div class="grid">
      <!-- FORM -->
      <div class="card">
        <h2>Dados do Contrato</h2>
        <div class="body">
          <div class="row">
            <div>
              <label for="cliente">Razão Social / Nome (Contratante)</label>
              <input id="cliente" placeholder="Ex.: Razão Social do Cliente" />
            </div>
            <div>
              <label for="clienteDoc">CNPJ/CPF (Contratante)</label>
              <input id="clienteDoc" placeholder="00.000.000/0000-00" />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="enderecoCliente">Endereço (Contratante)</label>
              <input id="enderecoCliente" placeholder="Rua, número, bairro" />
            </div>
            <div>
              <label for="contatoCliente">E-mail / Telefone (Contratante)</label>
              <input id="contatoCliente" placeholder="email@cliente.com | (xx) xxxxx-xxxx" />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="servico">Objeto / Serviço</label>
              <input id="servico" placeholder="Gestão de redes + tráfego pago" />
            </div>
            <div>
              <label for="valor">Valor Mensal</label>
              <input id="valor" placeholder="R$ 1.300,00" />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="vencimentoDia">Dia de vencimento</label>
              <input id="vencimentoDia" placeholder="Ex.: 08" />
            </div>
            <div>
              <label for="dataPrimeiroPgto">Data 1º Pagamento</label>
              <input id="dataPrimeiroPgto" type="date" />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="dataInicio">Data de início do serviço</label>
              <input id="dataInicio" type="date" />
            </div>
            <div>
              <label for="dataAssinatura">Data de assinatura</label>
              <input id="dataAssinatura" type="date" />
            </div>
          </div>

          <div>
            <label for="clausulasExtras">Cláusulas adicionais (opcional)</label>
            <textarea id="clausulasExtras" rows="4" placeholder="Ex.: Multa rescisória de 1 mensalidade na ausência de aviso prévio..."></textarea>
          </div>

          <div class="actions">
            <button class="btn" id="limpar">Limpar</button>
            <button class="btn ghost" id="restaurar">Restaurar rascunho</button>
            <button class="btn primary" id="gerar">Gerar contrato</button>
            <button class="btn success" id="pdf" disabled>Baixar PDF</button>
            <button class="btn" id="imprimir">Imprimir (PDF nativo)</button>
          </div>
          <p class="hint">Dica: “Imprimir (PDF nativo)” usa o gerador do próprio navegador. “Baixar PDF” usa html2pdf.js para criar o arquivo automaticamente.</p>
        </div>
      </div>

      <!-- PREVIEW -->
      <div class="card preview" id="previewCard" aria-live="polite">
        <div class="sheet" id="contrato">
          <div class="logo-wrap">
            <img src="./assets/ishelp-logo.png" alt="Is Help" />
          </div>
          <h1 class="header-title">CONTRATO DE PRESTAÇÃO DE SERVIÇOS</h1>
          <p class="meta">Este contrato documenta a proposta de prestação de serviços apresentada pela CONTRATADA e aceita previamente pela CONTRATANTE, contendo metodologia, recursos, condições de pagamento e prazos.</p>

          <div class="contract two-cols" id="contractBody">
            <!-- DADOS DA CONTRATADA (fixos) -->
            <div class="section-title">DADOS DA CONTRATADA</div>
            <p>
              <strong>Razão Social:</strong> IS HELP REPRESENTAÇÕES COMERCIAIS LTDA<br/>
              <strong>CNPJ:</strong> 31.280.692/0001-00<br/>
              <strong>E-mail:</strong> contato@ishelp.com.br &nbsp;|&nbsp; <strong>Celular/Fixo:</strong> (34) 98822-7461<br/>
              <strong>Endereço:</strong> AV. FLORIANO PEIXOTO, 1767 – NOSSA SENHORA APARECIDA, UBERLÂNDIA/MG – CEP 38400-700
            </p>

            <!-- DADOS DA CONTRATANTE (dinâmicos) -->
            <div class="section-title">DADOS DA CONTRATANTE</div>
            <p>
              <strong>Razão Social / Nome:</strong> <span data-merge="cliente">[Cliente]</span><br/>
              <strong>CNPJ/CPF:</strong> <span data-merge="clienteDoc">[Documento]</span><br/>
              <strong>Endereço:</strong> <span data-merge="enderecoCliente">[Endereço]</span><br/>
              <strong>Contato:</strong> <span data-merge="contatoCliente">[E-mail / Telefone]</span>
            </p>

            <div class="section-title">CLÁUSULA PRIMEIRA — DA PRESTAÇÃO DE SERVIÇOS</div>
            <p>O presente contrato tem por objeto a prestação dos serviços de <strong><span data-merge="servico">[Serviço]</span></strong>, compreendendo, entre outros:</p>
            <ul>
              <li>Gerenciamento de campanhas de anúncios nas redes sociais (Meta) e/ou Google Ads.</li>
              <li>Acompanhamento de desempenho e otimizações contínuas; a CONTRATANTE arca com o custo de mídia.</li>
              <li>Criação de textos originais para posts, com boas práticas de SEO quando aplicável.</li>
              <li>Seleção de imagens de domínio público quando não houver material fornecido; criação de peças gráficas pela CONTRATADA.</li>
              <li>Monitoramento de engajamento e relatórios simples mensais quando houver patrocínio de campanhas.</li>
            </ul>

            <div class="section-title">CLÁUSULA SEGUNDA — CONDIÇÕES DA PRESTAÇÃO</div>
            <p><em>Item I — Obrigações da CONTRATADA</em></p>
            <ul>
              <li>Produzir conteúdo para as plataformas digitais abrangidas.</li>
              <li>Preservar a imagem da CONTRATANTE em consonância com o CDC e o CENP; publicações somente com autorização prévia.</li>
              <li>Canal oficial de validação via WhatsApp em horário comercial (09:00–18:00, seg.–sex.).</li>
            </ul>
            <p><em>Item II — Obrigações da CONTRATANTE</em></p>
            <ul>
              <li>Fornecer insumos/informações necessários em até 72h quando solicitado.</li>
              <li>Entregar textos/ideias/imagens com antecedência máxima de 72h da data pretendida de publicação.</li>
              <li>Cumprir prazos de pagamento e de envio de material.</li>
              <li>Responder pelos conteúdos e tributos decorrentes, observando a legislação aplicável.</li>
            </ul>

            <div class="section-title">CLÁUSULA TERCEIRA — VALORES E FORMAS DE PAGAMENTO</div>
            <ul>
              <li>Formas de pagamento: Boleto, Pix ou Cartão de crédito (automático).</li>
              <li>O não pagamento até a data de vencimento poderá ensejar notificação prévia e suspensão do serviço.</li>
              <li>Em caso de cancelamento dentro do período, não haverá devolução integral ou proporcional dos valores pagos.</li>
              <li>Itens fora do escopo contratado poderão ser cobrados à parte mediante autorização prévia da CONTRATANTE.</li>
            </ul>

            <div class="section-title">CLÁUSULA QUARTA — RESCISÃO DE CONTRATO</div>
            <ul>
              <li>Em caso de rescisão por parte da CONTRATANTE, a CONTRATADA deve ser comunicada com aviso prévio de 30 (trinta) dias.</li>
              <li>O contrato poderá ser rescindido por extinção de qualquer das partes, decretação de recuperação/falência ou decurso natural do prazo.</li>
              <li>Na ausência do aviso prévio, poderá ser cobrado o equivalente a 1 (uma) mensalidade adicional referente ao período não comunicado.</li>
            </ul>
            <!-- OBS: Removido o trecho de "fidelidade de 6 meses" conforme solicitado -->

            <div class="section-title">CLÁUSULA QUINTA — DISPOSIÇÕES GERAIS</div>
            <ul>
              <li>Direitos autorais do projeto pertencem à CONTRATADA; autorizada a divulgação em portfólio e canais próprios.</li>
              <li>A CONTRATADA pode delegar atividades a terceiros sob sua responsabilidade.</li>
              <li>As partes são independentes; este instrumento não cria vínculo empregatício ou de representação.</li>
              <li>A tolerância a descumprimentos não implica novação; direitos podem ser exercidos a qualquer tempo.</li>
              <li>A impossibilidade de prestação por omissões/atrasos da CONTRATANTE em insumos/aprovações não caracteriza descumprimento pela CONTRATADA.</li>
              <li>Aplica-se, no que couber, Lei 4.680/65, Decretos 57.690/66 e 4.563/02, Lei 9.610/98 e normas do CENP.</li>
            </ul>

            <div class="section-title">FORMA DE PAGAMENTO, VENCIMENTO E PERÍODO</div>
            <p>
              <strong>Modalidade:</strong> Boleto/Pix ( &nbsp;&nbsp; ) &nbsp; Cartão de crédito ( &nbsp;&nbsp; )<br/>
              <strong>Data 1º pagamento:</strong> <span data-merge="dataPrimeiroPgtoLegivel">[Data]</span><br/>
              <strong>Dia de vencimento:</strong> <span data-merge="vencimentoDia">[Dia]</span><br/>
              <strong>Início da prestação:</strong> <span data-merge="dataInicioLegivel">[Data]</span>
            </p>

            <div class="section-title">ASSINATURA E VALOR</div>
            <p>
              <strong>Serviço contratado:</strong> <span data-merge="servico">[Serviço]</span><br/>
              <strong>Valor mensal:</strong> <span data-merge="valor">[Valor]</span>
            </p>

            <p style="margin-top:14px">
              Informo que recebi a documentação impressa: _________ (assinatura do cliente)
            </p>
            <p>
              Assinatura: _________________________________ &nbsp;&nbsp; Data: <span data-merge="dataAssinaturaLegivel">[Data]</span>
            </p>

            <div class="sign">
              <div>
                <div class="sign-line"><span data-merge="cliente">[Cliente]</span></div>
                CONTRATANTE
              </div>
              <div>
                <div class="sign-line">IS HELP REPRESENTAÇÕES COMERCIAIS LTDA</div>
                CONTRATADA
              </div>
            </div>
          </div><!-- /contractBody -->
        </div>
      </div>
    </div>
  </div>

  <script>
    // Utilidades
    const $ = s => document.querySelector(s);
    const $$ = s => [...document.querySelectorAll(s)];
    const get = id => document.getElementById(id);

    const fields = [
      "cliente","clienteDoc","enderecoCliente","contatoCliente",
      "servico","valor","vencimentoDia","dataPrimeiroPgto","dataInicio","dataAssinatura","clausulasExtras"
    ];

    // Datas padrão hoje (Brasil)
    (function setDefaultDates(){
      const iso = (d)=>`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
      const today = new Date();
      ["dataPrimeiroPgto","dataInicio","dataAssinatura"].forEach(id=>{
        if(!get(id).value) get(id).value = iso(today);
      });
    })();

    // Restaurar rascunho
    (function loadDraft(){
      try{
        const saved = JSON.parse(localStorage.getItem('ishelp-contrato-draft')||'{}');
        fields.forEach(f=>{ if(saved[f]) get(f).value = saved[f]; });
      }catch(e){}
    })();

    // Autosave
    fields.forEach(f=>{
      get(f).addEventListener('input',()=>{
        const o={}; fields.forEach(ff=>o[ff]=get(ff).value);
        localStorage.setItem('ishelp-contrato-draft',JSON.stringify(o));
      });
    });

    // Botões
    get('limpar').addEventListener('click',()=>{
      fields.forEach(f=>get(f).value='');
      localStorage.removeItem('ishelp-contrato-draft');
      get('pdf').disabled = true;
      merge();
    });
    get('restaurar').addEventListener('click',()=>{
      const saved = JSON.parse(localStorage.getItem('ishelp-contrato-draft')||'{}');
      fields.forEach(f=>get(f).value=saved[f]||''); merge();
    });
    get('imprimir').addEventListener('click',()=>window.print());

    function brDate(iso){
      if(!iso) return '';
      const [y,m,d]=iso.split('-');
      return `${d}/${m}/${y}`;
    }

    function merge(){
      const map={}; fields.forEach(f=>map[f]=(get(f).value||'').trim());
      map['dataPrimeiroPgtoLegivel']=brDate(map['dataPrimeiroPgto'])||'[Data]';
      map['dataInicioLegivel']=brDate(map['dataInicio'])||'[Data]';
      map['dataAssinaturaLegivel']=brDate(map['dataAssinatura'])||'[Data]';

      $$('[data-merge]').forEach(el=>{
        const key=el.getAttribute('data-merge');
        el.textContent = map[key] || `[${key}]`;
      });

      // Inserir cláusulas extras (se houver)
      const extras = (map['clausulasExtras']||'').trim();
      const extrasAnchor = document.querySelector('.section-title + p + ul + .section-title + ul + .section-title + ul + .section-title + ul'); // âncora após Rescisão
      // Nota: o template já contempla "Cláusulas adicionais" via campo abaixo (opcional). Vamos apenas anexar ao final do corpo:
      const container = document.getElementById('contractBody');
      const existing = document.getElementById('extrasBlock');
      if(existing) existing.remove();
      if(extras){
        const b=document.createElement('div'); b.id='extrasBlock';
        b.innerHTML = `<div class="section-title">CLÁUSULAS ADICIONAIS</div><p>${extras.replace(/\n/g,'<br/>')}</p>`;
        container.appendChild(b);
      }

      // Habilitar PDF se campos essenciais preenchidos
      const ok = !!(map['cliente'] && map['servico'] && map['valor']);
      get('pdf').disabled = !ok;
      return ok;
    }

    merge();
    fields.forEach(f=>get(f).addEventListener('change',merge));
    get('gerar').addEventListener('click',()=>{
      const ok=merge();
      if(ok){ document.getElementById('previewCard').scrollIntoView({behavior:'smooth',block:'start'}); }
      else { alert('Preencha pelo menos: Cliente, Serviço e Valor.'); }
    });

    // PDF
    get('pdf').addEventListener('click',async ()=>{
      merge();
      const el = document.getElementById('contrato');
      const fileName = `Contrato_${(get('cliente').value||'cliente').replace(/\s+/g,'_')}.pdf`;
      const opt = {
        margin:[10,10,10,10],
        filename:fileName,
        image:{type:'jpeg',quality:0.98},
        html2canvas:{scale:2,useCORS:true},
        jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}
      };
      try{ await html2pdf().from(el).set(opt).save(); }
      catch(e){ console.error(e); alert('Falha ao gerar PDF. Tente usar "Imprimir (PDF nativo)".'); }
    });
  </script>
</body>
</html>
